language: rust
rust:
- nightly

# Install grub-mkrescue
addons:
  apt:
    packages:
    - grub-common
    - gcc-multilib

# Install cargo-make and rust-src rustup component
before_install:
- cargo install cargo-update || echo "cargo-update already installed"
- cargo install cargo-make || echo "cargo-make already installed"
- cargo install-update cargo-update cargo-make cargo-xbuild
- rustup target install i686-unknown-linux-gnu || echo "target i686-unknown-linux-gnu already installed"

script:
- cargo make iso
- cargo make iso-release
- cargo make test
- cargo make doc-full

cache: cargo
